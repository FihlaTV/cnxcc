cnxcc Module

Carlos Ruiz Díaz

   ConexionGroup S.A.

   Copyright © 2012 Carlos Ruiz Díaz, carlos.ruizdiaz@gmail.com
   ____________________________________________________________

   Table of Contents

   1. Admin Guide

        1. Overview
        2. Dependencies

              2.1. Modules

        3. Parameters

              3.1. dlg_flag (integer)

        4. Functions

              4.1. cnxcc_set_max_time()               

        5. Exported RPC Commands

              5.1. cnxcc.active_clients
              5.2. cnxcc.check_client
              5.3. cnxcc.kill_call              

   List of Examples
   
   1.1 
   
Chapter 1. Admin Guide

   Table of Contents

    1. Overview
    2. Dependencies

        2.1. Modules

    3. Parameters

        3.1. dlg_flag (integer)

    4. Functions

        4.1. cnxcc_set_max_time()               

    5. Exported RPC Commands

        5.1. cnxcc.active_clients
        5.2. cnxcc.check_client
        5.3. cnxcc.kill_call
        
1. Overview

   The cnxcc module was created to limit call duration in a multiple-calls/single-client 
   scenario where a single client, identified by a unique value, is making 
   several calls at the same time and consuming its remaining seconds at 
   a rate that is equal to the number of concurrent calls that is having.
   
   Cnxcc can be used if your AAA software does not mantain the state of 
   the calls it authorizes. For example, consider a call that successfully 
   passed through the authorizer program to the "active" state and two minutes 
   later another call arrived trying to be authorized: our accounting program 
   runs every time a BYE is received and since the first call is still online, 
   the credit was not updated while the second call arrived and it will be 
   authorized using outdated credit information.

   If the first call was authorized with a maximum talk-time of 200 seconds, 
   the module will make sure it ends 200 seconds later. If a second call enters 
   while the first call is running its 100 seconds, the module is smart enough 
   to know that the 100 seconds remaining has to be splitted in two. In consequence, 
   it will make the first call to last 150 seconds (100 which was already consumed 
   plus 50 more seconds), and the second call 50 seconds. 

   In common cases, both calls will end before the credit is fully exhausted 
   and in this case, no money is lost, but when the credit is about to end 
   but still available, a call can easily consume more credit than it has 
   and in that situation, cnxcc module can help you to automatically shutdown 
   all calls when the credit reaches zero.

   Every time a call is forced to end, a event route is called. With this 
   route you can easily inform to the accounting program what just happened so 
   it can update the credit information in order to avoid new calls being 
   authorized. You can also tear down the RTP proxy leg, log, or do whatever
   task that might be needed.

   If the module is properly configured, all calls are maintained in memory 
   so no disk I/O operation is involved. This makes the module a lot faster.

   # INCOMPLETE, WORK IN PROGRESS #
   
